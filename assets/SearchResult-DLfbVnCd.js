import{K as _,j as se,L as te,M as I,N as ae,P as le,O as re,s as ie,l as T,m as Q,Q as oe,n as Y,k as t,R as ce,S as $,T as ue,U as ne,V as de,W as me,X as he,Y as ve,v as pe,Z as ye,z as ge,$ as we,i as fe,a0 as F,a1 as M,a2 as He,a3 as x,a4 as ke}from"./app-C6gSQRA4.js";const Re=["/","/intro.html","/docs/interview/css.html","/docs/interview/express.html","/docs/interview/mongoDB.html","/docs/interview/network.html","/docs/interview/nodejs.html","/docs/interview/nuxt.html","/docs/interview/typescript.html","/docs/interview/webpack.html","/docs/program/algorithm.html","/docs/program/designPattern.html","/docs/life/emo.html","/docs/life/happyTime.html","/docs/share/chrome-plugin.html","/docs/share/gitMultipleAccounts.html","/docs/share/md.html","/docs/share/mini-skateboards.html","/docs/share/mobile.html","/docs/share/pac-pet.html","/docs/share/picgo.html","/docs/share/qqMusicVsNetEaseMusic.html","/docs/share/snippets.html","/docs/share/stableDiffustion.html","/docs/share/vuePress.html","/docs/team/codingStandard.html","/docs/interview/base/%E4%B8%AD%E7%BA%A7.html","/docs/interview/base/%E5%88%9D%E7%BA%A7.html","/docs/interview/base/%E9%AB%98%E7%BA%A7.html","/docs/interview/mobileTerminal/wxApp.html","/docs/interview/vue/vue.html","/docs/interview/vue/vue3.html","/docs/program/algorithm/api.html","/docs/program/algorithm/base.html","/docs/program/algorithm/hw-cd.html","/docs/program/algorithm/problems.html","/docs/program/commands/git.html","/docs/program/commands/npm.html","/docs/program/commands/nvm.html","/docs/program/commands/yarn.html","/docs/team/ci-cd/ci-cd.html","/docs/team/ci-cd/git-flow.html","/docs/team/ci-cd/jenkins.html","/404.html","/docs/interview/","/docs/","/docs/program/","/docs/life/","/docs/share/","/docs/team/","/docs/interview/base/","/docs/interview/mobileTerminal/","/docs/interview/vue/","/docs/program/algorithm/","/docs/program/commands/","/docs/team/ci-cd/","/category/","/tag/","/article/","/star/","/timeline/"],be="SEARCH_PRO_QUERY_HISTORY",g=_(be,[]),Qe=()=>{const{queryHistoryCount:a}=x,l=a>0;return{enabled:l,queryHistory:g,addQueryHistory:r=>{l&&(g.value=Array.from(new Set([r,...g.value.slice(0,a-1)])))},removeQueryHistory:r=>{g.value=[...g.value.slice(0,r),...g.value.slice(r+1)]}}},P=a=>Re[a.id]+("anchor"in a?`#${a.anchor}`:""),xe="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:U}=x,w=_(xe,[]),Ae=()=>{const a=U>0;return{enabled:a,resultHistory:w,addResultHistory:l=>{if(a){const r={link:P(l),display:l.display};"header"in l&&(r.header=l.header),w.value=[r,...w.value.slice(0,U-1)]}},removeResultHistory:l=>{w.value=[...w.value.slice(0,l),...w.value.slice(l+1)]}}},qe=a=>{const l=me(),r=I(),A=he(),o=T(0),k=Q(()=>o.value>0),v=ve([]);return pe(()=>{const{search:p,terminate:q}=ye(),f=He(n=>{const H=n.join(" "),{searchFilter:S=h=>h,splitWord:E,suggestionsFilter:j,...y}=l.value;H?(o.value+=1,p(n.join(" "),r.value,y).then(h=>S(h,H,r.value,A.value)).then(h=>{o.value-=1,v.value=h}).catch(h=>{console.warn(h),o.value-=1,o.value||(v.value=[])})):v.value=[]},x.searchDelay-x.suggestDelay);Y([a,r],([n])=>f(n),{immediate:!0}),ge(()=>{q()})}),{isSearching:k,results:v}};var Ee=se({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:l}){const r=te(),A=I(),o=ae(le),{enabled:k,addQueryHistory:v,queryHistory:p,removeQueryHistory:q}=Qe(),{enabled:f,resultHistory:n,addResultHistory:H,removeResultHistory:S}=Ae(),E=k||f,j=re(a,"queries"),{results:y,isSearching:h}=qe(j),i=ie({isQuery:!0,index:0}),d=T(0),m=T(0),B=Q(()=>E&&(p.value.length>0||n.value.length>0)),D=Q(()=>y.value.length>0),C=Q(()=>y.value[d.value]||null),V=()=>{const{isQuery:e,index:s}=i;s===0?(i.isQuery=!e,i.index=e?n.value.length-1:p.value.length-1):i.index=s-1},N=()=>{const{isQuery:e,index:s}=i;s===(e?p.value.length-1:n.value.length-1)?(i.isQuery=!e,i.index=0):i.index=s+1},z=()=>{d.value=d.value>0?d.value-1:y.value.length-1,m.value=C.value.contents.length-1},K=()=>{d.value=d.value<y.value.length-1?d.value+1:0,m.value=0},W=()=>{m.value<C.value.contents.length-1?m.value+=1:K()},X=()=>{m.value>0?m.value-=1:z()},L=e=>e.map(s=>ke(s)?s:t(s[0],s[1])),Z=e=>{if(e.type==="customField"){const s=we[e.index]||"$content",[c,b=""]=fe(s)?s[A.value].split("$content"):s.split("$content");return e.display.map(u=>t("div",L([c,...u,b])))}return e.display.map(s=>t("div",L(s)))},R=()=>{d.value=0,m.value=0,l("updateQuery",""),l("close")},G=()=>k?t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},o.value.queryHistory),p.value.map((e,s)=>t("div",{class:["search-pro-result-item",{active:i.isQuery&&i.index===s}],onClick:()=>{l("updateQuery",e)}},[t(F,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},e),t("button",{class:"search-pro-remove-icon",innerHTML:M,onClick:c=>{c.preventDefault(),c.stopPropagation(),q(s)}})]))])):null,J=()=>f?t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},o.value.resultHistory),n.value.map((e,s)=>t($,{to:e.link,class:["search-pro-result-item",{active:!i.isQuery&&i.index===s}],onClick:()=>{R()}},()=>[t(F,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(c=>L(c)).flat())]),t("button",{class:"search-pro-remove-icon",innerHTML:M,onClick:c=>{c.preventDefault(),c.stopPropagation(),S(s)}})]))])):null;return oe("keydown",e=>{if(a.isFocusing){if(D.value){if(e.key==="ArrowUp")X();else if(e.key==="ArrowDown")W();else if(e.key==="Enter"){const s=C.value.contents[m.value];v(a.queries.join(" ")),H(s),r.push(P(s)),R()}}else if(f){if(e.key==="ArrowUp")V();else if(e.key==="ArrowDown")N();else if(e.key==="Enter"){const{index:s}=i;i.isQuery?(l("updateQuery",p.value[s]),e.preventDefault()):(r.push(n.value[s].link),R())}}}}),Y([d,m],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["search-pro-result-wrapper",{empty:a.queries.length?!D.value:!B.value}],id:"search-pro-results"},a.queries.length?h.value?t(ce,{hint:o.value.searching}):D.value?t("ul",{class:"search-pro-result-list"},y.value.map(({title:e,contents:s},c)=>{const b=d.value===c;return t("li",{class:["search-pro-result-list-item",{active:b}]},[t("div",{class:"search-pro-result-title"},e||o.value.defaultTitle),s.map((u,ee)=>{const O=b&&m.value===ee;return t($,{to:P(u),class:["search-pro-result-item",{active:O,"aria-selected":O}],onClick:()=>{v(a.queries.join(" ")),H(u),R()}},()=>[u.type==="text"?null:t(u.type==="title"?ue:u.type==="heading"?ne:de,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[u.type==="text"&&u.header?t("div",{class:"content-header"},u.header):null,t("div",Z(u))])])})])})):o.value.emptyResult:E?B.value?[G(),J()]:o.value.emptyHistory:o.value.emptyResult)}});export{Ee as default};
